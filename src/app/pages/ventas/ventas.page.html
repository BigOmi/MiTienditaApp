<ion-content [fullscreen]="true" class="ventas-content" (click)="onContentClick()">
  <div class="contenedor-principal">
    <!-- Filtros -->
    <div class="filtros">
      <ion-searchbar
        [(ngModel)]="busqueda"
        placeholder="Buscar ventas..."
        debounce="300"
        (ionInput)="filtrarVentas()"
        class="buscador"
      ></ion-searchbar>

      <div class="filtro-fecha-con-calendario">
        <ion-select
          placeholder="Filtro fecha"
          interface="popover"
          [(ngModel)]="filtroFecha"
          (ionChange)="filtrarVentas()"
        >
          <ion-select-option value="ninguno">Ninguno</ion-select-option>
          <ion-select-option value="dia">Por Día</ion-select-option>
          <ion-select-option value="semana">Por Semana</ion-select-option>
          <ion-select-option value="mes">Por Mes</ion-select-option>
        </ion-select>

        <!-- Ícono + calendario alineado -->
        <div class="icono-calendario" (click)="$event.stopPropagation()">
          <ion-icon
            name="calendar-outline"
            class="calendario"
            (click)="toggleCalendar()"
          ></ion-icon>

          <ion-datetime
            *ngIf="showCalendar"
            [(ngModel)]="fechaSeleccionada"
            (ionChange)="onFechaChange($event)"
            presentation="date"
            class="datetime-inline"
          ></ion-datetime>
        </div>
      </div>
    </div>

    <!-- Mostrar semana seleccionada -->
    <div *ngIf="semanaSeleccionada" class="semana-rango">
      <strong>{{ semanaSeleccionada.inicio }}</strong> a
      <strong>{{ semanaSeleccionada.fin }}</strong>
    </div>

    <!-- Tabla -->
    <div class="tabla-card">
      <table class="ventas-tabla">
        <thead>
          <tr>
            <th>ID Venta</th>
            <th>Productos</th>
            <th>Usuario</th>
            <th>Pago</th>
            <th>Total</th>
            <th>Fecha</th>
            <th>Hora</th>
            <th>Status</th>
            <th>Detalles</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let venta of ventasFiltradas">
            <td>{{ venta.id }}</td>
            <td>{{ venta.cantidad }}</td>
            <td>{{ venta.usuario }}</td>
            <td>{{ venta.metodoPago }}</td>
            <td>${{ venta.total }}</td>
            <td>{{ venta.fecha }}</td>
            <td>{{ venta.hora }}</td>
            <td>{{ venta.status }}</td>
            <td>
              <button (click)="verDetalles(venta)" class="ver-ticket">
                Ver ticket
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Total vendido -->
    <div class="total-vendido">
      <p>Total vendido</p>
      <strong>${{ totalVendido }}</strong>
    </div>
  </div>
</ion-content>
